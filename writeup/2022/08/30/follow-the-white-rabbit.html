<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- title will be injected from _config.yml -->
  <!-- Stylesheets -->
  
  <link rel="stylesheet" href="/assets/css/bootstrap.css">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="stylesheet" href="/assets/css/responsive.css">
  <link rel="stylesheet" href="/assets/css/import_custom.css">

  <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
  <link rel="icon" href="images/favicon.png" type="image/x-icon">

  <!-- Responsive -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script><![endif]-->
  <!--[if lt IE 9]><script src="js/respond.js"></script><![endif]--><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>BRZ - Sonderchallenge | LetzPwn - Luxembourgish CTF Team</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="BRZ - Sonderchallenge" />
<meta name="author" content="Voyyce" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Description Follow the white Darknet rabbit http://2kgc7j4qi3gtmzxuwfkthifcsboeh4ws4na3mar5xk2mjp6xi47x7cyd.onion/" />
<meta property="og:description" content="Description Follow the white Darknet rabbit http://2kgc7j4qi3gtmzxuwfkthifcsboeh4ws4na3mar5xk2mjp6xi47x7cyd.onion/" />
<link rel="canonical" href="/writeup/2022/08/30/follow-the-white-rabbit.html" />
<meta property="og:url" content="/writeup/2022/08/30/follow-the-white-rabbit.html" />
<meta property="og:site_name" content="LetzPwn - Luxembourgish CTF Team" />
<meta property="og:image" content="/img/followthewhiterabbit0_thumbnail.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-08-30T17:40:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/img/followthewhiterabbit0_thumbnail.png" />
<meta property="twitter:title" content="BRZ - Sonderchallenge" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Voyyce"},"dateModified":"2022-08-30T17:40:00+00:00","datePublished":"2022-08-30T17:40:00+00:00","description":"Description Follow the white Darknet rabbit http://2kgc7j4qi3gtmzxuwfkthifcsboeh4ws4na3mar5xk2mjp6xi47x7cyd.onion/","headline":"BRZ - Sonderchallenge","image":"/img/followthewhiterabbit0_thumbnail.png","mainEntityOfPage":{"@type":"WebPage","@id":"/writeup/2022/08/30/follow-the-white-rabbit.html"},"url":"/writeup/2022/08/30/follow-the-white-rabbit.html"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="/feed.xml" title="LetzPwn - Luxembourgish CTF Team" /></head><body>
  <div class="page-wrapper"><!-- Main Header -->
<header class="main-header">
  <!-- Header Top -->
  <div class="header-top">
    <div class="auto-container clearfix">

      <div class="top-left clearfix">
        <ul class="info-list">
          <li>The first Luxembourgish CTF Team</li>
        </ul>
      </div>

      <div class="top-right">
        <ul class="social-icons">
          <li><a href="https://twitter.com/LetzPwn"><span class="fab fa-twitter"></span></a></li>
          <li><a href="https://discord.gg/Qjt5zUc"><span class="fab fa-discord"></span></a></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Header Upper -->
  <div class="header-upper">
    <div class="inner-container">
      <div class="auto-container clearfix">
        <!--Logo-->
        <div class="logo-outer">
          <div class="logo"><a href="/"><img src="/assets/images/logo.png" alt=""
                title="Gamon - Digital Gaming and Esports HTML Template" style="max-width: 260px;"></a></div>
        </div>

        <!--Nav Box-->
        <div class="nav-outer clearfix">
          <!--Mobile Navigation Toggler-->
          <div class="mobile-nav-toggler"><span class="icon flaticon-menu-1"></span></div>

          <!-- Main Menu -->
          <nav class="main-menu navbar-expand-md navbar-light">
            <div class="collapse navbar-collapse show clearfix" id="navbarSupportedContent">
              <ul class="navigation clearfix pull-left">
                
                
                <li class=""><a href="/">Home</a>
                </li>
                
                
                
                <li class=""><a href="/about_us.html">About Us</a>
                </li>
                
                
                
                <li class=""><a href="/events.html">News & CTFs</a>
                </li>
                
                
              </ul>

                <ul class="navigation clearfix pull-right">
                  
                    
                    <li class=""><a href="/sponsors.html">Sponsors</a> </li>
                    
                  
                    
                    <li class=""><a href="/writeups.html">Writeups</a> </li>
                    
                  
                    
                    <li class=""><a href="/contact.html">Contact</a> </li>
                    
                  
                </ul>
            </div>
          </nav>
          <!-- Main Menu End-->
        </div>
      </div>
    </div>
  </div>
  <!--End Header Upper-->

  <!-- Sticky Header  -->
  <div class="sticky-header">
    <div class="auto-container clearfix">
      <!--Logo-->
      <div class="logo pull-left">
        <a href="/" title=""><img src="/assets/images/logo.png" style="max-width:100px;" alt="" title=""></a>
      </div>
      <!--Right Col-->
      <div class="pull-right">
        <!-- Main Menu -->
        <nav class="main-menu clearfix">
          <!--Keep This Empty / Menu will come through Javascript-->
        </nav><!-- Main Menu End-->
      </div>
    </div>
  </div><!-- End Sticky Menu -->

  <!-- Mobile Menu  -->
  <div class="mobile-menu">
    <div class="menu-backdrop"></div>
    <div class="close-btn"><span class="icon flaticon-close"></span></div>

    <nav class="menu-box">
      <div class="nav-logo"><a href="/"><img src="/assets/images/logo.png" alt="" title=""></a></div>
      <div class="menu-outer">
        <!--Here Menu Will Come Automatically Via Javascript / Same Menu as in Header-->
      </div>
      <!--Social Links--
      <div class="social-links">
        <ul class="clearfix">
          <li><a href="#"><span class="fab fa-twitter"></span></a></li>
          <li><a href="#"><span class="fab fa-facebook-square"></span></a></li>
          <li><a href="#"><span class="fab fa-pinterest-p"></span></a></li>
          <li><a href="#"><span class="fab fa-instagram"></span></a></li>
          <li><a href="#"><span class="fab fa-youtube"></span></a></li>
        </ul>
      </div>-->
    </nav>
  </div><!-- End Mobile Menu -->
</header>
<!--Page Title-->
<div itemscope itemtype="http://schema.org/BlogPosting">
  <section class="page-banner" style="padding-bottom: 40px; background-image:url(/assets/images/background/1.png);">
    <div class="auto-container">
      <div class="inner-container clearfix">
        <ul class="bread-crumb clearfix">
          <li><a href="/index.html">Home</a></li> 
          <li><a href="/writeups.html">Writeups</a></li>
          <li><a href="#">BRZ - Sonderchallenge</a></li> <!-- TODO: correct href-->
          <li itemprop="name headline">BRZ - Sonderchallenge Writeup</li>
        </ul>
        <h1>BRZ - Sonderchallenge Writeup</h1><ul class="custom-author">
                <li>By <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span
                      class="p-author h-card" itemprop="name">Voyyce</span></span>
                </li>
              </ul>
              <br/><div class="custom-date">Aug 30, 2022</div>
        <ul class="tags">
          <li>Solves: N/A teams</li>
          <li>Source: <a href="https://ecsc.hacking-lab.com/" target="_blank" rel="noopener noreferrer">https://ecsc.hacking-lab.com/</a></li>
        </ul>
    </div>
  </section>
  <!--End Page Title-->

  <!--Sidebar Page Container-->
  <div class="sidebar-page-containe" style="padding-top: 40px; background-color:#202020">
    <div class="auto-container">
      <div class="row clearfix">

        <!--Content Side / Blog Detail-->
        <div class="content-side col-lg-8 col-md-12 col-sm-12">
          <div class="blog-detail">
            <div class="lower-content writeup-content awsm" style="padding-top: 0px;">
              <p> <h2 id="description">Description</h2>
<blockquote>
  <p>Follow the white Darknet rabbit</p>
  <ul>
    <li>http://2kgc7j4qi3gtmzxuwfkthifcsboeh4ws4na3mar5xk2mjp6xi47x7cyd.onion/</li>
  </ul>
</blockquote>

<p><img src="img/followthewhiterabbit0_thumbnail.png" alt="" /></p>

<h2 id="tldr">TL;DR</h2>
<p>lorem ipsum</p>

<h2 id="complete-writeup">Complete Writeup</h2>

<p>I once did a webchallenge about an <em>Alice in Wonderland</em> theme and that was about bruteforcing <code class="language-plaintext highlighter-rouge">/r/a/b/b/i/t</code> directories so just to not miss any hint, I look up exactly what <code class="language-plaintext highlighter-rouge">following the white rabbit means</code>:</p>
<blockquote>
  <p>following the white rabbit means following an unlikely clue, an innocuous, unbelievable (but also, frankly a bit ridiculous) sign, to find oneself in the midst of more or less extraordinary, marvelous, amazing circumstances that challenge one’s fundamental beliefs</p>
</blockquote>

<p>Now I hope this challenge isnt about following guessy, unlikely clues too much, but let’s start with the actual challenge.</p>

<p>We receive a link to a <code class="language-plaintext highlighter-rouge">.onion</code> site. Navigating to it with tor browser shows the website depicted in the description of the challenge.
Now in order to successfully enumerate this site and use any tools, we need to configure those tools to route the traffic through the tor network.
Therefore we first start the tor service:
<img src="img/followthewhiterabbit1_tor.png" alt="" /></p>

<p>Having done this, I configure burpsuite to route the traffic through  tor:
<img src="img/followthewhiterabbit2_burpproxyconfig.png" alt="" /></p>

<p>Now we can also tell gobuster to use tor as a proxy:
<img src="img/followthewhiterabbit3_gobusterthroughtor.png" alt="" />
As we see, we already found 2 directories with gobuster.</p>

<p>Accessing both of those directories gives us a <code class="language-plaintext highlighter-rouge">403 Access denied</code> though.
Also additional bruteforcing of subdirectories reveals nothing. So I take a look at the traffic in burp. Navigating to the main site triggers several calls to images:</p>

<p><img src="img/followthewhiterabbit4_callstoimages.png" alt="" /></p>

<p>Also, the site sets a cookie:
<img src="img/followthewhiterabbit5_cookie.png" alt="" /></p>

<p>Looks like bytes. Decoding it looks like base64 which in turn reveals the following:</p>

<p><img src="img/followthewhiterabbit6_cookiedecoding.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PW:I-am-_Your-password
Key:C7
</code></pre></div></div>

<p>Looking at the response html, we can find text <code class="language-plaintext highlighter-rouge">Tag:jqmjrqappoWoqaK0h6uotLO0oqqu6aSoq6ip</code> (invisible in browser; the <code class="language-plaintext highlighter-rouge">t</code> id assigned to it is called in an onload eventlistener disabling display of that element). Might be useful later on.</p>

<p><img src="img/followthewhiterabbit7_htmlhiddentag.png" alt="" /></p>

<p>Also in the response html, there is an interesting element (invisible looking at the page in browser). Maybe we can also use that later on.</p>

<p>Also, there are links to <code class="language-plaintext highlighter-rouge">download/CyberSecurityChallenge_Matrix.exe</code> (visible in browser) and <code class="language-plaintext highlighter-rouge">cat:j2qmlapokqaHk0h6uoAEtLq6aSo36ipO</code> (invisible in browser).</p>

<p><img src="img/followthewhiterabbit8_htmlhiddenlink.png" alt="" /></p>

<p>When accessing the CyberSecurityChallenge_Matrix.exe file, we get a <code class="language-plaintext highlighter-rouge">401 Unauthorized</code>. The browser prompts us for credentials:
<img src="img/followthewhiterabbit9_downloadprompt.png" alt="" /></p>

<p>(Note: if you are using the tor browser for this, it should just show the popup; but if youre running this traffic through burpsuite, it will fail to do so. In order to fix this, in burp you need to go to <code class="language-plaintext highlighter-rouge">User options</code> -&gt; <code class="language-plaintext highlighter-rouge">Connections</code> -&gt; <code class="language-plaintext highlighter-rouge">Platform Authentication</code> and tick <code class="language-plaintext highlighter-rouge">Prompt for credentials on platform authentication failure</code>; this will then cause burp to prompt you with required authorization, otherwise it will just show a failed download of the .exe file)</p>

<p>I tried the stuff I found until now that I haven’t used yet. However, none of the potential credentials worked, but maybe I missed something.</p>

<p>Then I decided to take a closer look at the two weird strings I found in the html:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Tag:jqmjrqappoWoqaK0h6uotLO0oqqu6aSoq6ip</code></li>
  <li><code class="language-plaintext highlighter-rouge">cat:j2qmlapokqaHk0h6uoAEtLq6aSo36ipO</code></li>
</ul>

<p>The two strings are oddly similar to one another, so I am thinking this is some kind of encoding or something of the sort. It looks like base64 at first, but decoding it just gives random nonsense:
<img src="img/followthewhiterabbit10_base64decodeattempt.png" alt="" /></p>

<p>Not giving up on the idea that it is some encoding/encryption, I tried the tool ciphey (https://github.com/Ciphey/Ciphey)</p>
<blockquote>
  <p>[Ciphey is a] fully automated decryption/decoding/cracking tool using natural language processing &amp; artificial intelligence, along with some common sense.</p>

  <p><img src="img/followthewhiterabbit11_ciphey.png" alt="" /></p>
</blockquote>

<p>It looks like the string was the encoded version of what looks like an email address <code class="language-plaintext highlighter-rouge">IndianaBones@lostsemi.colon</code>. If we look at how the encryption/encoding takes place, it is first XORed with key 199 and then base64ed. And since 199 (in decimal) equals to C7 (in hex), we now also know what the line <code class="language-plaintext highlighter-rouge">Key:C7</code> meant that we got from the cookie.</p>

<p>Okay so, now we have a password (obtained from the cookie) and a potential username (the email address) to use on the download:</p>

<p><img src="img/followthewhiterabbit12_downloadpromptfilled.png" alt="" /></p>

<p>And indeed, we can download the file:
<img src="img/followthewhiterabbit13_downloadfile.png" alt="" /></p>

<p>The file is a PE32 Windows executable:</p>

<p><img src="img/followthewhiterabbit14_filecommand.png" alt="" /></p>

<p>This means that (if we’re on linux) we can execute it via wine. Before doing that however, I run the <code class="language-plaintext highlighter-rouge">strings</code> command on it and see if the flag is somewhere in there. From the challenge description, I know what I am looking for:
<img src="img/followthewhiterabbit15_flagformat.png" alt="" /></p>

<p><img src="img/followthewhiterabbit16_stringscommand.png" alt="" /></p>

<p>Even though what I find is not really in the flag format, it still looks like something I will need.</p>

<p>First I think it might be another encoded/encrypted piece of text. However, ciphey does not find anything.</p>

<p>After being stuck on it for a while, I go back over what I found previously and remember that I only used one encoded string up until now (the one that gave me the email address). Since the 2 strings look somewhat similar, I try the same decryption algorithm (base64, XOR with key C7) on the second one, but no luck - it doesnt decrypt to anything that makes sense.</p>

<p>After scanning it online with virustotal, I execute the file using wine:</p>

<p>After saying <code class="language-plaintext highlighter-rouge">Connecting...</code> and loading shortly, it prints random chars to the terminal</p>

<p><img src="img/followthewhiterabbit17_welcometotheCSC.png" alt="" /></p>

<p>Now, it displays a Welcome-To-The-Challenge message and says that “this is not the hint you’re looking for …” in German.
So no direct luck there.</p>

<p>Playing around a little with the string I found using the <code class="language-plaintext highlighter-rouge">strings</code> command, I decide to try it as directory (after all it is still a web challenge and apart from using the tor browser), up until now it did not have to do that much with web. And indeed, in said directory, we find the flag:</p>

<p><img src="img/followthewhiterabbit18_flag.txt.png" alt="" /></p>

<p><code class="language-plaintext highlighter-rouge">CSC:{e68e11be8b70e435c65aef8ba9798ff7775c361e}</code></p>

<h2 id="lessons-learned">Lessons learned</h2>
<p>Even though I am familiar with how the theoretical concept and practical implementation behind TOR works, I am not that familiar with actually interacting with the darknet, so I definitely learned something there - especially in relation to routing certain traffic (gobuster, burpsuite) over TOR.</p>

<h2 id="final-thoughts">Final thoughts</h2>

<p>Even though I learned something, I was a little disappointed with what the challenge was about. Since the challenge was marked as a <code class="language-plaintext highlighter-rouge">web</code> challenge, I expected more sorts of actual web vulnerabilities. Of course the disappointment might come from the fact that I like web and that web is by far my best category, but in the end, this challenge was (apart from the TOR traffic routing) solely guessy encoding stuff.</p>
</p>
            </div>
          </div>

          <!-- Other Options -->
          <div class="post-share-options clearfix">
            <!--
            <div class="pull-left">
              <ul class="tags">
                <li><a href="#">Gaming</a></li>
                <li><a href="matches.html">Matches</a></li>
                <li><a href="#">Players</a></li>
              </ul>
            </div>
            -->
            <!--
            <div class="social-links pull-right">
              <ul class="social-links">
                <li><a href="#"><span class="fab fa-twitter"></span></a></li>
                <li><a href="#"><span class="fab fa-facebook-square"></span></a></li>
                <li><a href="#"><span class="fab fa-pinterest-p"></span></a></li>
                <li><a href="#"><span class="fab fa-instagram"></span></a></li>
              </ul>
            </div>
            -->
          </div>
        </div>

        <!--Sidebar Side-->
        <div class="sidebar-side col-lg-4 col-md-12 col-sm-12">
          <aside class="sidebar">

            <!-- Tags Widget -->
            <div class="sidebar-widget popular-tags">
              <div class="widget-content">
                <h4 class="sidebar-title">Task categories</h4>
                
                  <a href="#">web</a>
                
                  <a href="#">darknet</a>
                
              </div>
            </div>

            <!-- Search -->
            <!--
            <div class="sidebar-widget search-box">
              <form method="post" action="contact.html">
                <div class="form-group">
                  <input type="search" name="search-field" value="" placeholder="Search" required>
                  <button type="submit"><span class="icon fa fa-search"></span></button>
                </div>
              </form>
            </div>
            -->

            <!-- Post Widget -->
            <div class="sidebar-widget popular-posts">
              <div class="widget-content">
                <h4 class="sidebar-title">Recent Writeups</h4>
                
                
                
                
                
                
                
                
                
                <article class="post">
                  <div class="post-inner">
                    
                    
                    <figure class="post-thumb"><a href="/writeup/2019/10/27/Numtonce.html"><img src="/writeup/2019/10/27/website.png"
                          alt=""></a></figure>
                    <div class="post-info">Aug 30, 2022</div>
                    <div class="text"><a href="/writeup/2019/10/27/Numtonce.html">Numtonce</a></div>
                  </div>

                </article>
                
                
                
                <article class="post">
                  <div class="post-inner">
                    
                    
                    <figure class="post-thumb"><a href="/writeup/2020/02/05/Draw_with_us.html"><img src="/writeup/2020/02/05/website.png"
                          alt=""></a></figure>
                    <div class="post-info">Aug 30, 2022</div>
                    <div class="text"><a href="/writeup/2020/02/05/Draw_with_us.html">Draw with us</a></div>
                  </div>

                </article>
                
                
              </div>
            </div>

            <!-- Category Widget -->
            <!--
            <div class="sidebar-widget categories">
              <div class="widget-content">
                <h4 class="sidebar-title">Categories</h4>
                <ul class="blog-categories">
                  <li><a href="blog-single.html">Gaming</a></li>
                  <li><a href="blog-single.html">Matches</a></li>
                  <li><a href="blog-single.html">Video games</a></li>
                  <li><a href="blog-single.html">Esports</a></li>
                  <li><a href="blog-single.html">Champions</a></li>
                </ul>
              </div>
            </div>
            -->
          </aside>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- End Sidebar Page Container -->

	<!-- Main Footer -->
  <footer class="main-footer">
    	<div class="auto-container">
        	<!--Widgets Section-->
            <div class="widgets-section">
            	<div class="row clearfix">
                	
                    <!--Column-->
                    <div class="column col-lg-4 col-md-6 col-sm-12">
						<div class="footer-widget logo-widget">
							<div class="logo">
                            	<a href="/index.html"><img src="/assets/images/logo.png" alt="" /></a>
                            </div>
							<div class="text"></div>
						</div>
					</div>
					
					<!--Column-->
                    <div class="column col-lg-4 col-md-6 col-sm-12">
						<div class="footer-widget links-widget">
							<div class="widget-content">
								<div class="footer-title">
									<h2>Links</h2>
								</div>
								<div class="row clearfix">
									<div class="column col-lg-6 col-md-6 col-sm-12">
										<ul class="list">
											<li><a href="/about_us.html">About</a></li>
											<li><a href="/members.html">Our Team</a></li>
											<li><a href="/events.html">News and CTFs</a></li>
											<li><a href="/contact.html">Contact</a></li>
										</ul>
									</div>
									<div class="column col-lg-6 col-md-6 col-sm-12">
										<ul class="list">
											<li><a href="/contact.html">Help & Support</a></li>
											<li><a href="/privacy_policy.html">Privacy Policy</a></li>
										</ul>
									</div>
								</div>
							</div>	
						</div>
					</div>
					
					<!--Column                    <div class="column col-lg-4 col-md-6 col-sm-12">
						<div class="footer-widget newsletter-widget">
							<div class="footer-title">
                            	<h2>Newsletter</h2>
                            </div>
							<div class="text">Subsrcibe us now to get the latest news and updates</div>
							<div class="newsletter-form">
                                <form method="post" action="contact.html">
                                    <div class="form-group clearfix">
                                        <input type="email" name="email" value="" placeholder="Email address" required>
                                        <button type="submit" class="theme-btn newsletter-btn"><span class="fas fa-envelope"></span></button>
                                    </div>
                                </form>
                            </div>
						</div>
					</div>
					-->

				</div>
			</div>
		</div>
		
		<!-- Footer Bottom -->
		<div class="footer-bottom">
			<div class="auto-container">
				<!--Scroll to top-->
				<div class="scroll-to-top scroll-to-target" data-target="html"><span class="flaticon-up-arrow"></span></div>
				<!--Scroll to top-->
				<div class="row clearfix">
					<!-- Column -->
					<div class="column col-lg-6 col-md-12 col-sm-12">
						<div class="copyright">&copy; Copyrights, 2019 All Rights Reserved</div>
					</div>
					<!-- Column -->
					<div class="column col-lg-6 col-md-12 col-sm-12">
						<ul class="social-icons">
							<li><a href="https://twitter.com/letzpwn"><span class="fab fa-twitter"></span></a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		
  </footer>
  
</div>
<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/popper.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>
<script src="/assets/js/jquery-ui.js"></script>
<script src="/assets/js/jquery.fancybox.js"></script>
<script src="/assets/js/owl.js"></script>
<script src="/assets/js/appear.js"></script>
<script src="/assets/js/wow.js"></script>
<script src="/assets/js/scrollbar.js"></script>
<script src="/assets/js/script.js"></script></body>

</html>